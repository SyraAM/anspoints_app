<!DOCTYPE html>
<html>
  <head>
      <title>ANS Points</title>
      <%= csrf_meta_tags %>
      <%= csp_meta_tag %>
      <%= stylesheet_link_tag 'points', media: 'all', 'data-turbolinks-track': 'reload' %>
      <%= stylesheet_pack_tag 'points', media: 'all', 'data-turbolinks-track': 'reload' %>
      <%= javascript_pack_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  </head>
  <body>
    <div id="events-container" class="container">            
      <h1 class="title">Admin Points Dashboard</h1>
    </div>

    <div class="search-container">
      <input type="text" id="searchTableInput" onkeyup="filterTable()" placeholder="Search emails..">
    </div>

    <div class="table-container">
      <table id="pointsTable" class="table table-responsive table-bordered table-hover table-striped table-md">
        <thead class="table-head">
          <tr>
            <th scope="col" class="table-header" data-field="index" data-align="center" data-sortable="true">#</th>
            <th scope="col" class="table-header" data-field="index" data-align="center" data-sortable="true">Email</th>
            <th scope="col" class="table-header" data-field="id" data-align="center" data-sortable="true">Points</th>
          </tr>
        </thead>
        <tbody>
          <% i = 1 %>
          <% @user_points_counts.each do |data| %>
          <tr>
            <td><%= i %></td>
            <td><%= data.email %></td>
            <td><%= data.count %></td>
          </tr>
          <% i = i + 1 %> 
          <% end %>
        </tbody>
      </table>
    </div>
  
    <script>
    function filterTable() {
      // Declare variables
      var input, filter, table, tr, td, i, txtValue;
      input = document.getElementById("searchTableInput");
      filter = input.value.toUpperCase();
      table = document.getElementById("pointsTable");
      tr = table.getElementsByTagName("tr");

      // Loop through all table rows, and hide those who don't match the search query
      for (i = 0; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[1];
        if (td) {
          txtValue = td.textContent || td.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }
      }
    }
    </script>
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.2/umd/popper.min.js" integrity="sha512-2rNj2KJ+D8s1ceNasTIex6z4HWyOnEYLVC3FigGOmyQCZc2eBXKgOxQmo3oKLHyfcj53uz4QMsRCWNbLd32Q1g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  </body>
</html>